---
layout: post
title: Flask-Migrate 数据库
abbrlink: 619160cf57f84e198fa2e041d28ad748
tags: []
categories:
  - IT
  - 开发
  - Python
  - Flask
date: 1631341465018
updated: 1758161617885
---

## 安装

```bash
pip install Flask-Migrate
```

## 初始化

```python
from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///app.db'

db = SQLAlchemy(app)
migrate = Migrate(app, db)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(128))
```

```bash
# 单个库
flask db init
# 多个库
flask db init --multidb
```

## 修改模型

```bash
~/.pyenv/versions/sqlacodegen/bin/sqlacodegen mysql://ITXiaoPang:xxxxxx@127.0.0.1/davinci|pbcopy
```

## 显示当前版本和上个版本

```bash
flask db show
```

## 迁移

```bash
flask db migrate -m "Initial migration."
```

## 升级

```bash
flask db upgrade --sql
```

```bash
flask db upgrade
```
