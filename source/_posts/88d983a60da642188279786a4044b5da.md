---
layout: post
title: json-editor使用select2并自定义参数
abbrlink: 88d983a60da642188279786a4044b5da
tags:
  - select2
  - json-editor
categories:
  - IT
  - 开发
  - 前端
date: 1681802746912
updated: 1757408052350
---

## 显示

```javascript
let code_extra = new JSONEditor(document.getElementById('code_extra'),{
    theme: 'bootstrap5',
    iconlib: "fontawesome5",
    disable_properties: true,
    enable_array_copy: true,
    disable_edit_json: false,
    schema: {
        type: "object",
        required: ["domaind"],
        properties: {
            domaind: {
                title: "自身域名",
                type: "array",
                items: {
                    format: "select2",
                    title: "域名",
                    type: "string",
                    enum: [],
                    options: {
                        select2: {
                            language: 'zh-CN',
                            width: '100%',
                            dropdownParent: $('#modal_code_edit'),
                            allowClear: false,
                            minimumInputLength: 0,
                            tags: true,
                            multiple: false,
                            ajax: {
                                url: "{{url_for('select2.api_select2_domaind_det')}}",
                                dataType: 'json',
                                delay: 250,
                                processResults: function(data) {
                                    return {
                                        results: $.map(data.results, function(item) {
                                            return {
                                                text: item.text,
                                                id: item.id
                                            }
                                        })
                                    };
                                }
                            }
                        }
                    }
                },
            },
        }
    }
});
```

## 写回

```javascript
let row_code_extra = JSON.parse(row.code_extra);
set_json_editor_value(code_extra, row_code_extra);
let res_array = row_code_extra.res;
if (res_array) {
    // 查找所有select2控件并处理
    $('#code_extra').find('select.form-select').each(function(i, item_select2) {
        // 查询已选择的数据
        let url='{{url_for("select2.api_select2_domaind_det")}}';
        url+='?domaind_ids=' + res_array[i];
        // 将结果加载到当前select2选项中
        let jq_obj = $(item_select2);
        load_select2(url, jq_obj);
    })
}
```
